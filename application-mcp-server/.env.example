# ================================
# Azure AD Configuration (Required)
# ================================
AZURE_CLIENT_ID=your-application-client-id
AZURE_CLIENT_SECRET=your-client-secret
AZURE_TENANT_ID=your-tenant-id

# IMPORTANT: 
# - For application permissions, you MUST use your organization's specific tenant ID
# - Cannot use "common" or "consumers" 
# - Find your tenant ID in Azure Portal > Azure Active Directory > Overview

# ================================
# HTTP Client Configuration
# ================================
# Timeout for HTTP requests in seconds
HTTP_TIMEOUT=30.0

# Maximum number of connections in the pool
HTTP_MAX_CONNECTIONS=100

# Maximum number of keepalive connections
HTTP_MAX_KEEPALIVE=20

# ================================
# Retry Configuration
# ================================
# Maximum number of retries for failed requests
MAX_RETRIES=3

# Maximum wait time for retry-after responses (seconds)
RETRY_MAX_WAIT=60

# ================================
# Concurrency Configuration
# ================================
# Maximum number of concurrent Graph API requests
# Adjust based on your Microsoft Graph API throttling limits
MAX_CONCURRENT_REQUESTS=50

# ================================
# Rate Limiting Configuration
# ================================
# Format: "max_requests,time_period_seconds"
# These limits prevent exceeding Microsoft Graph API quotas
# Based on official Microsoft documentation: https://learn.microsoft.com/en-us/graph/throttling

# Global rate limit (applies to all endpoints unless overridden)
# Default: 2000 requests per 10 seconds
RATE_LIMIT_GLOBAL=2000,10

# Mail API (messages, mailFolders)
# Default: 10,000 requests per 10 minutes (600 seconds)
RATE_LIMIT_MAIL=10000,600

# Calendar API (calendar, events)
# Default: 10,000 requests per 10 minutes
RATE_LIMIT_CALENDAR=10000,600

# Teams Channel Messages (heavily throttled by Microsoft)
# Default: 120 requests per 60 seconds (1 minute)
RATE_LIMIT_TEAMS_MESSAGES=120,60

# Search API (very restrictive)
# Default: 5 requests per second
RATE_LIMIT_SEARCH=5,1

# User/Group API
# Default: 10,000 requests per 10 minutes
RATE_LIMIT_USERS=10000,600

# OneDrive/Files API
# Default: 10,000 requests per 10 minutes
RATE_LIMIT_FILES=10000,600

# Online Meetings API
# Default: 10,000 requests per 10 minutes
RATE_LIMIT_MEETINGS=10000,600

# ================================
# Logging Configuration
# ================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log format: json (for production) or text (for development)
LOG_FORMAT=json

# ================================
# Server Configuration
# ================================
# FastAPI server host
FASTAPI_HOST=0.0.0.0

# FastAPI server port
FASTAPI_PORT=8000

# MCP server host
MCP_HOST=0.0.0.0

# MCP server port
MCP_PORT=8001
